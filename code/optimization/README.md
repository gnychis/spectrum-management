All code related to the actual optimization
